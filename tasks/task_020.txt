# Task ID: 20
# Title: Investment Performance Analysis
# Status: pending
# Dependencies: 17, 19
# Priority: high
# Description: Add tools for analyzing investment performance across different time periods with detailed metrics and visualizations.
# Details:
Create a Performance Analysis sheet with comprehensive investment performance metrics:

1. Performance Overview section:
   - Total return (absolute and percentage)
   - Annualized return
   - Volatility
   - Sharpe ratio

2. Performance by Time Period section:
   - Calculate returns for standard periods (1D, 1W, 1M, 3M, 6M, YTD, 1Y, All)
   - Show start value, end value, absolute change, and percentage change
   - Create bar chart comparing performance across periods

3. Top Performers section:
   - List top 5 holdings by return percentage
   - Show ticker, name, value, absolute return, and percentage return

4. Bottom Performers section:
   - List bottom 5 holdings by return percentage
   - Show ticker, name, value, absolute return, and percentage return

Implement helper functions to:
- Calculate performance metrics using portfolio history data
- Determine performance for different time periods
- Calculate holding-level performance using transaction history
- Format data appropriately for display

Ensure all calculations handle edge cases (e.g., no data for certain periods, zero values).

# Test Strategy:
1. Test performance calculations with sample portfolio data
2. Verify time period calculations with different date ranges
3. Test annualized return and volatility calculations
4. Verify top/bottom performers identification is correct
5. Test with different portfolio compositions and time periods
6. Verify calculations match expected results from manual calculations
